/* ==========================================================================
   Images
   http://www.w3.org/TR/css3-images/
   ========================================================================== */

// Common variables
@images-path: "../images/";

/**
 * Sprite
 * https://css-tricks.com/css-sprites/
 *
 * @example
 * .sprite(@image: "icons.png"; @fragments: home, cube, mail, profile, nav, search, map;);
 *
 * @example
 * @file: "icons/context-menu.png";
 * @actions: add, save, edit, remove, cancel;
 * .sprite(@image: @file; @fragments: @actions; @size: 18;);
 * .sprite(@image: @file; @fragments: @actions; @size: 18; @top: 18; @after: ~":hover";);
 */
.sprite(@image; @fragments; @size: 16; @left: 0; @top: 0; @width: @size; @height: @size; @axis: x;
    @before: ~""; @after: ~"";) {
    & {
        background-image: url("@{images-path}@{image}");
        background-repeat: no-repeat;
    }

    @col: round(@left / @width) + 1;
    @row: round(@top / @height) + 1;

    .position(@col, @row);

    .position(@x, @y) when (@@axis <= length(@fragments)) {
        @fragment-id: extract(@fragments, @@axis);

        @{before}&-@{fragment-id}@{after} {
            background-position: unit(-@width * (@x - 1), px) unit(-@height * (@y - 1), px);
        }
    }
    .position(@x, @y) when (@x <= length(@fragments)) and (@axis = x) {
        .position((@x + 1), @y);
    }
    .position(@x, @y) when (@y <= length(@fragments)) and (@axis = y) {
        .position(@x, (@y + 1));
    }
}